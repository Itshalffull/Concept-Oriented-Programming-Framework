kit:
  name: parse
  version: 0.1.0
  description: >
    Universal file parsing, structural identity, and pattern matching.
    Provides lossless syntax trees for every file in a COPF project
    via Tree-sitter WASM integration. Uses coordination + provider
    pattern for grammar registration and structural pattern engines.

concepts:
  SyntaxTree:
    spec: ./syntax-tree.concept
    params:
      T: { as: tree-id, description: "Syntax tree identifier" }

  LanguageGrammar:
    spec: ./language-grammar.concept
    params:
      G: { as: grammar-id, description: "Grammar identifier" }

  FileArtifact:
    spec: ./file-artifact.concept
    params:
      F: { as: artifact-id, description: "File artifact identifier" }

  DefinitionUnit:
    spec: ./definition-unit.concept
    params:
      D: { as: definition-id, description: "Definition identifier" }

  ContentDigest:
    spec: ./content-digest.concept
    params:
      H: { as: digest-id, description: "Digest identifier" }

  StructuralPattern:
    spec: ./structural-pattern.concept
    params:
      P: { as: pattern-id, description: "Pattern identifier" }

  # Grammar providers (optional plugins)
  TreeSitterTypeScript:
    spec: ./providers/grammars/typescript.concept
    optional: true
  TreeSitterJson:
    spec: ./providers/grammars/json.concept
    optional: true
  TreeSitterYaml:
    spec: ./providers/grammars/yaml.concept
    optional: true
  TreeSitterConceptSpec:
    spec: ./providers/grammars/concept-spec.concept
    optional: true
  TreeSitterSyncSpec:
    spec: ./providers/grammars/sync-spec.concept
    optional: true
  TreeSitterWidgetSpec:
    spec: ./providers/grammars/widget-spec.concept
    optional: true
  TreeSitterThemeSpec:
    spec: ./providers/grammars/theme-spec.concept
    optional: true

  # Pattern engine providers
  TreeSitterQueryProvider:
    spec: ./providers/patterns/tree-sitter-query.concept
    optional: true

syncs:
  required:
    - path: ./syncs/parse-on-change.sync
      name: ParseOnChangeSync
      description: >
        Parse files when content changes. Resolves grammar
        by extension, triggers SyntaxTree/parse.

    - path: ./syncs/file-artifact-registration.sync
      name: FileArtifactRegistrationSync
      description: >
        Register files as project artifacts on store.
        Infers role and language from path and extension.

  recommended:
    - path: ./syncs/definition-extraction.sync
      name: DefinitionExtractionSync
      description: >
        Extract definition-level nodes from parsed syntax trees.

    - path: ./syncs/content-digest.sync
      name: ContentDigestSync
      description: >
        Compute structural content hashes for extracted definitions.

  integration: []

uses:
  - kit: foundation
    concepts:
      - name: ContentNode
      - name: ContentParser
      - name: ContentStorage
  - kit: generation
    concepts:
      - name: Resource
  - kit: infrastructure
    concepts:
      - name: PluginRegistry

dependencies: []
