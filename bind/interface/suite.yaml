# kits/interface/kit.yaml
suite:
  name: interface
  version: 0.1.0
  description: >
    Multi-target interface generation for COPF applications.
    Generates REST APIs, GraphQL schemas, gRPC services, CLIs,
    MCP servers, SDKs, and specification documents from concept
    specs and an interface manifest.

concepts:
  # --- Orchestration Concepts ---
  Projection:
    spec: ./concepts/projection.concept
    params:
      P: { as: projection-ref, description: "Reference to an enriched concept projection" }

  Generator:
    spec: ./concepts/generator.concept
    params:
      G: { as: generator-plan-ref, description: "Reference to a generation plan" }

  # Emitter: imported from generation kit (see uses section below)

  ApiSurface:
    spec: ./concepts/api-surface.concept
    params:
      S: { as: surface-ref, description: "Reference to a composed API surface" }

  Middleware:
    spec: ./concepts/middleware.concept
    params:
      M: { as: middleware-ref, description: "Reference to a middleware definition" }

  Grouping:
    spec: ./concepts/grouping.concept
    params:
      G: { as: grouping-ref, description: "Reference to a concept grouping result" }

  ActionGuide:
    spec: ./concepts/action-guide.concept
    params:
      W: { as: workflow-ref, description: "Reference to an ordered action sequence" }

  Annotation:
    spec: ./concepts/annotation.concept
    params:
      N: { as: annotation-ref, description: "Reference to concept/action metadata" }

  EnrichmentRenderer:
    spec: ./concepts/enrichment-renderer.concept
    params:
      R: { as: renderer-handler-ref, description: "Reference to a registered render handler" }

  # --- Coordination Concepts ---
  Target:
    spec: ./concepts/target.concept
    params:
      T: { as: target-output-ref, description: "Reference to a target generation output" }

  Sdk:
    spec: ./concepts/sdk.concept
    params:
      S: { as: sdk-package-ref, description: "Reference to a generated SDK package" }

  Spec:
    spec: ./concepts/spec.concept
    params:
      D: { as: spec-document-ref, description: "Reference to a generated spec document" }

  # --- Target Provider Concepts (load what you need) ---
  RestTarget:
    spec: ./concepts/providers/rest-target.concept
    params:
      R: { as: rest-route-ref, description: "Reference to a generated REST route" }
    optional: true

  GraphqlTarget:
    spec: ./concepts/providers/graphql-target.concept
    params:
      Q: { as: graphql-type-ref, description: "Reference to a generated GraphQL type" }
    optional: true

  GrpcTarget:
    spec: ./concepts/providers/grpc-target.concept
    params:
      G: { as: grpc-service-ref, description: "Reference to a generated gRPC service" }
    optional: true

  CliTarget:
    spec: ./concepts/providers/cli-target.concept
    params:
      C: { as: cli-command-ref, description: "Reference to a generated CLI command" }
    optional: true

  McpTarget:
    spec: ./concepts/providers/mcp-target.concept
    params:
      M: { as: mcp-tool-ref, description: "Reference to a generated MCP tool" }
    optional: true

  ClaudeSkillsTarget:
    spec: ./concepts/providers/claude-skills-target.concept
    params:
      K: { as: claude-skill-ref, description: "Reference to a generated Claude Code skill" }
    optional: true

  # --- Spec Document Providers ---
  OpenApiTarget:
    spec: ./concepts/providers/openapi-target.concept
    params:
      O: { as: openapi-spec-ref, description: "Reference to a generated OpenAPI spec" }
    optional: true

  AsyncApiTarget:
    spec: ./concepts/providers/asyncapi-target.concept
    params:
      A: { as: asyncapi-spec-ref, description: "Reference to a generated AsyncAPI spec" }
    optional: true

  # --- SDK Language Providers (load what you need) ---
  TsSdkTarget:
    spec: ./concepts/providers/ts-sdk-target.concept
    params:
      S: { as: ts-sdk-package-ref, description: "Reference to a generated TypeScript SDK" }
    optional: true

  PySdkTarget:
    spec: ./concepts/providers/py-sdk-target.concept
    params:
      S: { as: py-sdk-package-ref, description: "Reference to a generated Python SDK" }
    optional: true

  GoSdkTarget:
    spec: ./concepts/providers/go-sdk-target.concept
    params:
      S: { as: go-sdk-module-ref, description: "Reference to a generated Go SDK module" }
    optional: true

  RustSdkTarget:
    spec: ./concepts/providers/rust-sdk-target.concept
    params:
      S: { as: rust-sdk-crate-ref, description: "Reference to a generated Rust SDK crate" }
    optional: true

  JavaSdkTarget:
    spec: ./concepts/providers/java-sdk-target.concept
    params:
      S: { as: java-sdk-artifact-ref, description: "Reference to a generated Java SDK artifact" }
    optional: true

  SwiftSdkTarget:
    spec: ./concepts/providers/swift-sdk-target.concept
    params:
      S: { as: swift-sdk-package-ref, description: "Reference to a generated Swift SDK package" }
    optional: true

syncs:
  required:
    - path: ./syncs/project-on-manifest.sync
    - path: ./syncs/validate-projection.sync
    - path: ./syncs/plan-on-valid.sync
    - path: ./syncs/generate-on-plan.sync
    - path: ./syncs/write-on-inject.sync
    - path: ./syncs/format-on-write.sync
    - path: ./syncs/group-before-dispatch.sync
    - path: ./syncs/workflow-before-render.sync
    - path: ./syncs/annotate-before-generate.sync
    - path: ./syncs/render-enrichment.sync

  recommended:
    - path: ./syncs/compose-on-complete.sync
      name: SurfaceComposition
    - path: ./syncs/clean-orphans.sync
      name: OrphanCleanup
    - path: ./syncs/block-on-breaking.sync
      name: BreakingChangeGuard

  integration:
    # Target dispatch and routing
    - path: ./syncs/dispatch-to-target.sync
    - path: ./syncs/dispatch-to-sdk.sync
    - path: ./syncs/dispatch-to-spec.sync
    - path: ./syncs/apply-middleware.sync
    - path: ./syncs/write-entrypoint.sync

    # Target routing
    - path: ./syncs/routing/route-to-rest.sync
    - path: ./syncs/routing/route-to-graphql.sync
    - path: ./syncs/routing/route-to-grpc.sync
    - path: ./syncs/routing/route-to-cli.sync
    - path: ./syncs/routing/route-to-mcp.sync
    - path: ./syncs/routing/route-to-claude-skills.sync

    # Spec routing
    - path: ./syncs/routing/route-to-openapi.sync
    - path: ./syncs/routing/route-to-asyncapi.sync

    # SDK routing
    - path: ./syncs/routing/route-to-ts-sdk.sync
    - path: ./syncs/routing/route-to-py-sdk.sync
    - path: ./syncs/routing/route-to-go-sdk.sync
    - path: ./syncs/routing/route-to-rust-sdk.sync
    - path: ./syncs/routing/route-to-java-sdk.sync
    - path: ./syncs/routing/route-to-swift-sdk.sync

    # Middleware injection
    - path: ./syncs/routing/inject-middleware-rest.sync
    - path: ./syncs/routing/inject-middleware-graphql.sync
    - path: ./syncs/routing/inject-middleware-grpc.sync
    - path: ./syncs/routing/inject-middleware-cli.sync
    - path: ./syncs/routing/inject-middleware-mcp.sync
    - path: ./syncs/routing/inject-middleware-claude-skills.sync

uses:
  - kit: generation
    concepts:
      - name: Emitter
        params:
          F: { as: emitter-file-ref, description: "Reference to a generated file" }
