// Auto-generated by COPF Interface Kit â€” cli target
// Concept: Resource
// Do not edit manually; regenerate with: copf interface generate

import { Command } from 'commander';

export const resourceCommand = new Command('resource')
  .description('Track input resources with content-addressed digests.');

resourceCommand
  .command('upsert')
  .description('Register or update a tracked input resource')
  .argument('<locator>', 'Locator')
  .requiredOption('-k, --kind <kind>', 'Resource kind (concept-spec, sync-spec, etc.)')
  .requiredOption('--digest <digest>', 'Content hash of the resource')
  .requiredOption('--last-modified <lastModified>', 'Last Modified')
  .requiredOption('--size <size>', 'Size')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'upsert', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });

resourceCommand
  .command('get')
  .description('Look up a tracked resource')
  .argument('<locator>', 'Locator')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'get', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });

resourceCommand
  .command('list')
  .description('List all tracked input resources')
  .option('-k, --kind <kind>', 'Filter by resource kind')
  .option('--json', 'Output as JSON')
  .addHelpText('after', '\nExamples:')
  .addHelpText('after', '  copf resource list  # List all tracked resources')
  .addHelpText('after', '  copf resource list --kind concept-spec  # List only concept specs')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'list', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });

resourceCommand
  .command('remove')
  .description('Stop tracking a resource')
  .argument('<locator>', 'Locator')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'remove', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });

resourceCommand
  .command('diff')
  .description('Classify a content change between two digests')
  .argument('<locator>', 'Locator')
  .requiredOption('--old-digest <oldDigest>', 'Old Digest')
  .requiredOption('--new-digest <newDigest>', 'New Digest')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'diff', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });

export const resourceCommandTree = {
  group: 'resource',
  description: 'Track input resources with content-addressed digests.',
  commands: [{ action: 'upsert', command: 'upsert' }, { action: 'get', command: 'get' }, { action: 'list', command: 'list' }, { action: 'remove', command: 'remove' }, { action: 'diff', command: 'diff' }],
};
