// Auto-generated by COPF Interface Kit â€” cli target
// Concept: JWT
// Do not edit manually; regenerate with: copf interface generate

import { Command } from 'commander';

export const jWTCommand = new Command('jwt')
  .description('Generate and verify JSON Web Tokens for user sessions');

jWTCommand
  .command('generate')
  .description('Create a JWT containing the user reference Store and return it')
  .requiredOption('--user <user>', 'User')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'generate', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });

jWTCommand
  .command('verify')
  .description('Decode the token Return the user reference')
  .requiredOption('--token <token>', 'Token')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'verify', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });
