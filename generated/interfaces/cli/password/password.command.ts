// Auto-generated by Clef Clef Bind â€” cli target
// Concept: Password
// Do not edit manually; regenerate with: clef interface generate

import { Command } from 'commander';

export const passwordCommand = new Command('password')
  .description('Securely store and validate user credentials using 
 salted hashing Does not handle reset flows those 
 are composed via synchronization with a token concept');

passwordCommand
  .command('set')
  .description('Generate a random salt Hash the password with the salt 
 Store both Return the user reference')
  .requiredOption('--user <user>', 'User')
  .requiredOption('--password <password>', 'Password')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'set', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });

passwordCommand
  .command('check')
  .description('Retrieve the salt for the user Hash the provided 
 password with it Return true if hashes match')
  .requiredOption('--user <user>', 'User')
  .requiredOption('--password <password>', 'Password')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'check', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });

passwordCommand
  .command('validate')
  .description('Check that the password meets strength requirements 
 without storing anything')
  .requiredOption('--password <password>', 'Password')
  .option('--json', 'Output as JSON')
  .action(async (opts) => {
    const result = await globalThis.kernel.handleRequest({ method: 'validate', ...opts });
    console.log(opts.json ? JSON.stringify(result) : result);
  });
