// Auto-generated by COPF Interface Kit â€” typescript-sdk target
// Concept: JWT
// Do not edit manually; regenerate with: copf interface generate


export class JWTClient {
  constructor(private baseUrl: string, private headers: Record<string, string> = {}) {}

  async generate(input: { user: string }): Promise<{ token: string }> {
    const res = await fetch(`${this.baseUrl}/api/jwts/${(input as Record<string, unknown>).id ?? ''}/generate`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', ...this.headers },
      body: JSON.stringify(input),
    });
    if (!res.ok) throw new Error(`generate failed: ${res.status}`);
    return res.json();
  }

  async verify(input: { token: string }): Promise<{ variant: 'ok'; user: string } | { variant: 'error'; message: string }> {
    const res = await fetch(`${this.baseUrl}/api/jwts/${(input as Record<string, unknown>).id ?? ''}/verify`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', ...this.headers },
      body: JSON.stringify(input),
    });
    if (!res.ok) throw new Error(`verify failed: ${res.status}`);
    return res.json();
  }
}
