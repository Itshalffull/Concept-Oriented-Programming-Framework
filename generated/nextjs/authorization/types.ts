// Authorization â€” types.ts
// Generated by NextjsGen. Do not edit manually.
// Uses fp-ts for purely functional, composable concept implementations.

// Storage interface for Authorization
export interface AuthorizationStorage {
  readonly get: (relation: string, key: string) => Promise<Record<string, unknown> | null>;
  readonly put: (relation: string, key: string, value: Record<string, unknown>) => Promise<void>;
  readonly delete: (relation: string, key: string) => Promise<boolean>;
  readonly find: (relation: string, filter?: Record<string, unknown>) => Promise<readonly Record<string, unknown>[]>;
}

export interface AuthorizationGrantPermissionInput {
  readonly role: string;
  readonly permission: string;
}

export interface AuthorizationGrantPermissionOutputOk {
  readonly variant: 'ok';
  readonly role: string;
  readonly permission: string;
}

export interface AuthorizationGrantPermissionOutputNotfound {
  readonly variant: 'notfound';
  readonly message: string;
}

export type AuthorizationGrantPermissionOutput = AuthorizationGrantPermissionOutputOk | AuthorizationGrantPermissionOutputNotfound;

export interface AuthorizationRevokePermissionInput {
  readonly role: string;
  readonly permission: string;
}

export interface AuthorizationRevokePermissionOutputOk {
  readonly variant: 'ok';
  readonly role: string;
  readonly permission: string;
}

export interface AuthorizationRevokePermissionOutputNotfound {
  readonly variant: 'notfound';
  readonly message: string;
}

export type AuthorizationRevokePermissionOutput = AuthorizationRevokePermissionOutputOk | AuthorizationRevokePermissionOutputNotfound;

export interface AuthorizationAssignRoleInput {
  readonly user: string;
  readonly role: string;
}

export interface AuthorizationAssignRoleOutputOk {
  readonly variant: 'ok';
  readonly user: string;
  readonly role: string;
}

export interface AuthorizationAssignRoleOutputNotfound {
  readonly variant: 'notfound';
  readonly message: string;
}

export type AuthorizationAssignRoleOutput = AuthorizationAssignRoleOutputOk | AuthorizationAssignRoleOutputNotfound;

export interface AuthorizationCheckPermissionInput {
  readonly user: string;
  readonly permission: string;
}

export interface AuthorizationCheckPermissionOutput {
  readonly variant: 'ok';
  readonly granted: boolean;
}

// --- Variant constructors ---

export const grantPermissionOk = (role: string, permission: string): AuthorizationGrantPermissionOutput => ({ variant: 'ok', role, permission } as AuthorizationGrantPermissionOutput);
export const grantPermissionNotfound = (message: string): AuthorizationGrantPermissionOutput => ({ variant: 'notfound', message } as AuthorizationGrantPermissionOutput);

export const revokePermissionOk = (role: string, permission: string): AuthorizationRevokePermissionOutput => ({ variant: 'ok', role, permission } as AuthorizationRevokePermissionOutput);
export const revokePermissionNotfound = (message: string): AuthorizationRevokePermissionOutput => ({ variant: 'notfound', message } as AuthorizationRevokePermissionOutput);

export const assignRoleOk = (user: string, role: string): AuthorizationAssignRoleOutput => ({ variant: 'ok', user, role } as AuthorizationAssignRoleOutput);
export const assignRoleNotfound = (message: string): AuthorizationAssignRoleOutput => ({ variant: 'notfound', message } as AuthorizationAssignRoleOutput);

export const checkPermissionOk = (granted: boolean): AuthorizationCheckPermissionOutput => ({ variant: 'ok', granted } as AuthorizationCheckPermissionOutput);

