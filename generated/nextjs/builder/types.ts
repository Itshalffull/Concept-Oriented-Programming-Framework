// Builder â€” types.ts
// Generated by NextjsGen. Do not edit manually.
// Uses fp-ts for purely functional, composable concept implementations.

import * as O from 'fp-ts/Option';

// Storage interface for Builder
export interface BuilderStorage {
  readonly get: (relation: string, key: string) => Promise<Record<string, unknown> | null>;
  readonly put: (relation: string, key: string, value: Record<string, unknown>) => Promise<void>;
  readonly delete: (relation: string, key: string) => Promise<boolean>;
  readonly find: (relation: string, filter?: Record<string, unknown>) => Promise<readonly Record<string, unknown>[]>;
}

export interface BuilderBuildInput {
  readonly concept: string;
  readonly source: string;
  readonly language: string;
  readonly platform: string;
  readonly config: { readonly mode: string; readonly features: O.Option<readonly string[]> };
}

export interface BuilderBuildOutputOk {
  readonly variant: 'ok';
  readonly build: string;
  readonly artifactHash: string;
  readonly artifactLocation: string;
  readonly duration: number;
}

export interface BuilderBuildOutputCompilationError {
  readonly variant: 'compilationError';
  readonly concept: string;
  readonly language: string;
  readonly errors: readonly { readonly file: string; readonly line: number; readonly message: string }[];
}

export interface BuilderBuildOutputTestFailure {
  readonly variant: 'testFailure';
  readonly concept: string;
  readonly language: string;
  readonly passed: number;
  readonly failed: number;
  readonly failures: readonly { readonly test: string; readonly message: string }[];
}

export interface BuilderBuildOutputToolchainError {
  readonly variant: 'toolchainError';
  readonly concept: string;
  readonly language: string;
  readonly reason: string;
}

export type BuilderBuildOutput = BuilderBuildOutputOk | BuilderBuildOutputCompilationError | BuilderBuildOutputTestFailure | BuilderBuildOutputToolchainError;

export interface BuilderBuildAllInput {
  readonly concepts: readonly string[];
  readonly source: string;
  readonly targets: readonly { readonly language: string; readonly platform: string }[];
  readonly config: { readonly mode: string; readonly features: O.Option<readonly string[]> };
}

export interface BuilderBuildAllOutputOk {
  readonly variant: 'ok';
  readonly results: readonly { readonly concept: string; readonly language: string; readonly artifactHash: string; readonly duration: number }[];
}

export interface BuilderBuildAllOutputPartial {
  readonly variant: 'partial';
  readonly completed: readonly { readonly concept: string; readonly language: string; readonly artifactHash: string }[];
  readonly failed: readonly { readonly concept: string; readonly language: string; readonly error: string }[];
}

export type BuilderBuildAllOutput = BuilderBuildAllOutputOk | BuilderBuildAllOutputPartial;

export interface BuilderTestInput {
  readonly concept: string;
  readonly language: string;
  readonly platform: string;
  readonly testFilter: O.Option<readonly string[]>;
  readonly testType: O.Option<string>;
  readonly toolName: O.Option<string>;
}

export interface BuilderTestOutputOk {
  readonly variant: 'ok';
  readonly passed: number;
  readonly failed: number;
  readonly skipped: number;
  readonly duration: number;
  readonly testType: string;
}

export interface BuilderTestOutputTestFailure {
  readonly variant: 'testFailure';
  readonly passed: number;
  readonly failed: number;
  readonly failures: readonly { readonly test: string; readonly message: string }[];
  readonly testType: string;
}

export interface BuilderTestOutputNotBuilt {
  readonly variant: 'notBuilt';
  readonly concept: string;
  readonly language: string;
}

export interface BuilderTestOutputRunnerNotFound {
  readonly variant: 'runnerNotFound';
  readonly language: string;
  readonly testType: string;
  readonly installHint: string;
}

export type BuilderTestOutput = BuilderTestOutputOk | BuilderTestOutputTestFailure | BuilderTestOutputNotBuilt | BuilderTestOutputRunnerNotFound;

export interface BuilderStatusInput {
  readonly build: string;
}

export interface BuilderStatusOutput {
  readonly variant: 'ok';
  readonly build: string;
  readonly status: string;
  readonly duration: O.Option<number>;
}

export interface BuilderHistoryInput {
  readonly concept: string;
  readonly language: O.Option<string>;
}

export interface BuilderHistoryOutput {
  readonly variant: 'ok';
  readonly builds: readonly { readonly language: string; readonly platform: string; readonly artifactHash: string; readonly duration: number; readonly completedAt: Date; readonly testsPassed: number }[];
}

// --- Variant constructors ---

export const buildOk = (build: string, artifactHash: string, artifactLocation: string, duration: number): BuilderBuildOutput => ({ variant: 'ok', build, artifactHash, artifactLocation, duration } as BuilderBuildOutput);
export const buildCompilationError = (concept: string, language: string, errors: readonly { readonly file: string; readonly line: number; readonly message: string }[]): BuilderBuildOutput => ({ variant: 'compilationError', concept, language, errors } as BuilderBuildOutput);
export const buildTestFailure = (concept: string, language: string, passed: number, failed: number, failures: readonly { readonly test: string; readonly message: string }[]): BuilderBuildOutput => ({ variant: 'testFailure', concept, language, passed, failed, failures } as BuilderBuildOutput);
export const buildToolchainError = (concept: string, language: string, reason: string): BuilderBuildOutput => ({ variant: 'toolchainError', concept, language, reason } as BuilderBuildOutput);

export const buildAllOk = (results: readonly { readonly concept: string; readonly language: string; readonly artifactHash: string; readonly duration: number }[]): BuilderBuildAllOutput => ({ variant: 'ok', results } as BuilderBuildAllOutput);
export const buildAllPartial = (completed: readonly { readonly concept: string; readonly language: string; readonly artifactHash: string }[], failed: readonly { readonly concept: string; readonly language: string; readonly error: string }[]): BuilderBuildAllOutput => ({ variant: 'partial', completed, failed } as BuilderBuildAllOutput);

export const testOk = (passed: number, failed: number, skipped: number, duration: number, testType: string): BuilderTestOutput => ({ variant: 'ok', passed, failed, skipped, duration, testType } as BuilderTestOutput);
export const testTestFailure = (passed: number, failed: number, failures: readonly { readonly test: string; readonly message: string }[], testType: string): BuilderTestOutput => ({ variant: 'testFailure', passed, failed, failures, testType } as BuilderTestOutput);
export const testNotBuilt = (concept: string, language: string): BuilderTestOutput => ({ variant: 'notBuilt', concept, language } as BuilderTestOutput);
export const testRunnerNotFound = (language: string, testType: string, installHint: string): BuilderTestOutput => ({ variant: 'runnerNotFound', language, testType, installHint } as BuilderTestOutput);

export const statusOk = (build: string, status: string, duration: O.Option<number>): BuilderStatusOutput => ({ variant: 'ok', build, status, duration } as BuilderStatusOutput);

export const historyOk = (builds: readonly { readonly language: string; readonly platform: string; readonly artifactHash: string; readonly duration: number; readonly completedAt: Date; readonly testsPassed: number }[]): BuilderHistoryOutput => ({ variant: 'ok', builds } as BuilderHistoryOutput);

