// Conformance â€” types.ts
// Generated by NextjsGen. Do not edit manually.
// Uses fp-ts for purely functional, composable concept implementations.

import * as O from 'fp-ts/Option';

// Storage interface for Conformance
export interface ConformanceStorage {
  readonly get: (relation: string, key: string) => Promise<Record<string, unknown> | null>;
  readonly put: (relation: string, key: string, value: Record<string, unknown>) => Promise<void>;
  readonly delete: (relation: string, key: string) => Promise<boolean>;
  readonly find: (relation: string, filter?: Record<string, unknown>) => Promise<readonly Record<string, unknown>[]>;
}

export interface ConformanceGenerateInput {
  readonly concept: string;
  readonly specPath: string;
}

export interface ConformanceGenerateOutputOk {
  readonly variant: 'ok';
  readonly suite: string;
  readonly testVectors: readonly { readonly id: string; readonly description: string; readonly input: string; readonly expectedOutput: string }[];
}

export interface ConformanceGenerateOutputSpecError {
  readonly variant: 'specError';
  readonly concept: string;
  readonly message: string;
}

export type ConformanceGenerateOutput = ConformanceGenerateOutputOk | ConformanceGenerateOutputSpecError;

export interface ConformanceVerifyInput {
  readonly suite: string;
  readonly language: string;
  readonly artifactLocation: string;
}

export interface ConformanceVerifyOutputOk {
  readonly variant: 'ok';
  readonly passed: number;
  readonly total: number;
  readonly coveredRequirements: readonly string[];
}

export interface ConformanceVerifyOutputFailure {
  readonly variant: 'failure';
  readonly passed: number;
  readonly failed: number;
  readonly failures: readonly { readonly testId: string; readonly requirement: string; readonly expected: string; readonly actual: string }[];
}

export interface ConformanceVerifyOutputDeviationDetected {
  readonly variant: 'deviationDetected';
  readonly requirement: string;
  readonly language: string;
  readonly reason: string;
}

export type ConformanceVerifyOutput = ConformanceVerifyOutputOk | ConformanceVerifyOutputFailure | ConformanceVerifyOutputDeviationDetected;

export interface ConformanceRegisterDeviationInput {
  readonly concept: string;
  readonly language: string;
  readonly requirement: string;
  readonly reason: string;
}

export interface ConformanceRegisterDeviationOutput {
  readonly variant: 'ok';
  readonly suite: string;
}

export interface ConformanceMatrixInput {
  readonly concepts: O.Option<readonly string[]>;
}

export interface ConformanceMatrixOutput {
  readonly variant: 'ok';
  readonly matrix: readonly { readonly concept: string; readonly targets: readonly { readonly language: string; readonly conformance: string; readonly covered: number; readonly total: number; readonly deviations: number }[] }[];
}

export interface ConformanceTraceabilityInput {
  readonly concept: string;
}

export interface ConformanceTraceabilityOutput {
  readonly variant: 'ok';
  readonly requirements: readonly { readonly id: string; readonly description: string; readonly testedBy: readonly { readonly language: string; readonly testId: string; readonly status: string }[] }[];
}

// --- Variant constructors ---

export const generateOk = (suite: string, testVectors: readonly { readonly id: string; readonly description: string; readonly input: string; readonly expectedOutput: string }[]): ConformanceGenerateOutput => ({ variant: 'ok', suite, testVectors } as ConformanceGenerateOutput);
export const generateSpecError = (concept: string, message: string): ConformanceGenerateOutput => ({ variant: 'specError', concept, message } as ConformanceGenerateOutput);

export const verifyOk = (passed: number, total: number, coveredRequirements: readonly string[]): ConformanceVerifyOutput => ({ variant: 'ok', passed, total, coveredRequirements } as ConformanceVerifyOutput);
export const verifyFailure = (passed: number, failed: number, failures: readonly { readonly testId: string; readonly requirement: string; readonly expected: string; readonly actual: string }[]): ConformanceVerifyOutput => ({ variant: 'failure', passed, failed, failures } as ConformanceVerifyOutput);
export const verifyDeviationDetected = (requirement: string, language: string, reason: string): ConformanceVerifyOutput => ({ variant: 'deviationDetected', requirement, language, reason } as ConformanceVerifyOutput);

export const registerDeviationOk = (suite: string): ConformanceRegisterDeviationOutput => ({ variant: 'ok', suite } as ConformanceRegisterDeviationOutput);

export const matrixOk = (matrix: readonly { readonly concept: string; readonly targets: readonly { readonly language: string; readonly conformance: string; readonly covered: number; readonly total: number; readonly deviations: number }[] }[]): ConformanceMatrixOutput => ({ variant: 'ok', matrix } as ConformanceMatrixOutput);

export const traceabilityOk = (requirements: readonly { readonly id: string; readonly description: string; readonly testedBy: readonly { readonly language: string; readonly testId: string; readonly status: string }[] }[]): ConformanceTraceabilityOutput => ({ variant: 'ok', requirements } as ConformanceTraceabilityOutput);

