// FlakyTest â€” types.ts
// Generated by NextjsGen. Do not edit manually.
// Uses fp-ts for purely functional, composable concept implementations.

import * as O from 'fp-ts/Option';

// Storage interface for FlakyTest
export interface FlakyTestStorage {
  readonly get: (relation: string, key: string) => Promise<Record<string, unknown> | null>;
  readonly put: (relation: string, key: string, value: Record<string, unknown>) => Promise<void>;
  readonly delete: (relation: string, key: string) => Promise<boolean>;
  readonly find: (relation: string, filter?: Record<string, unknown>) => Promise<readonly Record<string, unknown>[]>;
}

export interface FlakyTestRecordInput {
  readonly testId: string;
  readonly language: string;
  readonly builder: string;
  readonly testType: string;
  readonly passed: boolean;
  readonly duration: number;
}

export interface FlakyTestRecordOutputOk {
  readonly variant: 'ok';
  readonly test: string;
}

export interface FlakyTestRecordOutputFlakyDetected {
  readonly variant: 'flakyDetected';
  readonly test: string;
  readonly flipCount: number;
  readonly recentResults: readonly boolean[];
}

export type FlakyTestRecordOutput = FlakyTestRecordOutputOk | FlakyTestRecordOutputFlakyDetected;

export interface FlakyTestQuarantineInput {
  readonly testId: string;
  readonly reason: string;
  readonly owner: O.Option<string>;
}

export interface FlakyTestQuarantineOutputOk {
  readonly variant: 'ok';
  readonly test: string;
}

export interface FlakyTestQuarantineOutputAlreadyQuarantined {
  readonly variant: 'alreadyQuarantined';
  readonly test: string;
}

export interface FlakyTestQuarantineOutputNotFound {
  readonly variant: 'notFound';
  readonly testId: string;
}

export type FlakyTestQuarantineOutput = FlakyTestQuarantineOutputOk | FlakyTestQuarantineOutputAlreadyQuarantined | FlakyTestQuarantineOutputNotFound;

export interface FlakyTestReleaseInput {
  readonly testId: string;
}

export interface FlakyTestReleaseOutputOk {
  readonly variant: 'ok';
  readonly test: string;
}

export interface FlakyTestReleaseOutputNotQuarantined {
  readonly variant: 'notQuarantined';
  readonly test: string;
}

export type FlakyTestReleaseOutput = FlakyTestReleaseOutputOk | FlakyTestReleaseOutputNotQuarantined;

export interface FlakyTestIsQuarantinedInput {
  readonly testId: string;
}

export interface FlakyTestIsQuarantinedOutputYes {
  readonly variant: 'yes';
  readonly test: string;
  readonly reason: string;
  readonly owner: O.Option<string>;
  readonly quarantinedAt: Date;
}

export interface FlakyTestIsQuarantinedOutputNo {
  readonly variant: 'no';
  readonly test: string;
}

export interface FlakyTestIsQuarantinedOutputUnknown {
  readonly variant: 'unknown';
  readonly testId: string;
}

export type FlakyTestIsQuarantinedOutput = FlakyTestIsQuarantinedOutputYes | FlakyTestIsQuarantinedOutputNo | FlakyTestIsQuarantinedOutputUnknown;

export interface FlakyTestReportInput {
  readonly testType: O.Option<string>;
}

export interface FlakyTestReportOutput {
  readonly variant: 'ok';
  readonly summary: { readonly totalTracked: number; readonly currentlyFlaky: number; readonly quarantined: number; readonly stabilized: number; readonly topFlaky: readonly { readonly testId: string; readonly language: string; readonly testType: string; readonly flipCount: number; readonly owner: O.Option<string> }[] };
}

export interface FlakyTestSetPolicyInput {
  readonly flipThreshold: O.Option<number>;
  readonly flipWindow: O.Option<string>;
  readonly autoQuarantine: O.Option<boolean>;
  readonly retryCount: O.Option<number>;
}

export interface FlakyTestSetPolicyOutput {
  readonly variant: 'ok';
}

// --- Variant constructors ---

export const recordOk = (test: string): FlakyTestRecordOutput => ({ variant: 'ok', test } as FlakyTestRecordOutput);
export const recordFlakyDetected = (test: string, flipCount: number, recentResults: readonly boolean[]): FlakyTestRecordOutput => ({ variant: 'flakyDetected', test, flipCount, recentResults } as FlakyTestRecordOutput);

export const quarantineOk = (test: string): FlakyTestQuarantineOutput => ({ variant: 'ok', test } as FlakyTestQuarantineOutput);
export const quarantineAlreadyQuarantined = (test: string): FlakyTestQuarantineOutput => ({ variant: 'alreadyQuarantined', test } as FlakyTestQuarantineOutput);
export const quarantineNotFound = (testId: string): FlakyTestQuarantineOutput => ({ variant: 'notFound', testId } as FlakyTestQuarantineOutput);

export const releaseOk = (test: string): FlakyTestReleaseOutput => ({ variant: 'ok', test } as FlakyTestReleaseOutput);
export const releaseNotQuarantined = (test: string): FlakyTestReleaseOutput => ({ variant: 'notQuarantined', test } as FlakyTestReleaseOutput);

export const isQuarantinedYes = (test: string, reason: string, owner: O.Option<string>, quarantinedAt: Date): FlakyTestIsQuarantinedOutput => ({ variant: 'yes', test, reason, owner, quarantinedAt } as FlakyTestIsQuarantinedOutput);
export const isQuarantinedNo = (test: string): FlakyTestIsQuarantinedOutput => ({ variant: 'no', test } as FlakyTestIsQuarantinedOutput);
export const isQuarantinedUnknown = (testId: string): FlakyTestIsQuarantinedOutput => ({ variant: 'unknown', testId } as FlakyTestIsQuarantinedOutput);

export const reportOk = (summary: { readonly totalTracked: number; readonly currentlyFlaky: number; readonly quarantined: number; readonly stabilized: number; readonly topFlaky: readonly { readonly testId: string; readonly language: string; readonly testType: string; readonly flipCount: number; readonly owner: O.Option<string> }[] }): FlakyTestReportOutput => ({ variant: 'ok', summary } as FlakyTestReportOutput);

export const setPolicyOk = (): FlakyTestSetPolicyOutput => ({ variant: 'ok' } as FlakyTestSetPolicyOutput);

