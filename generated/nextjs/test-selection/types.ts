// TestSelection â€” types.ts
// Generated by NextjsGen. Do not edit manually.
// Uses fp-ts for purely functional, composable concept implementations.

import * as O from 'fp-ts/Option';

// Storage interface for TestSelection
export interface TestSelectionStorage {
  readonly get: (relation: string, key: string) => Promise<Record<string, unknown> | null>;
  readonly put: (relation: string, key: string, value: Record<string, unknown>) => Promise<void>;
  readonly delete: (relation: string, key: string) => Promise<boolean>;
  readonly find: (relation: string, filter?: Record<string, unknown>) => Promise<readonly Record<string, unknown>[]>;
}

export interface TestSelectionAnalyzeInput {
  readonly changedSources: readonly string[];
  readonly testType: O.Option<string>;
}

export interface TestSelectionAnalyzeOutputOk {
  readonly variant: 'ok';
  readonly affectedTests: readonly { readonly testId: string; readonly language: string; readonly testType: string; readonly relevance: number; readonly reason: string }[];
}

export interface TestSelectionAnalyzeOutputNoMappings {
  readonly variant: 'noMappings';
  readonly message: string;
}

export type TestSelectionAnalyzeOutput = TestSelectionAnalyzeOutputOk | TestSelectionAnalyzeOutputNoMappings;

export interface TestSelectionSelectInput {
  readonly affectedTests: readonly { readonly testId: string; readonly language: string; readonly testType: string; readonly relevance: number }[];
  readonly budget: O.Option<{ readonly maxDuration: number; readonly maxTests: number }>;
}

export interface TestSelectionSelectOutputOk {
  readonly variant: 'ok';
  readonly selected: readonly { readonly testId: string; readonly language: string; readonly testType: string; readonly priority: number }[];
  readonly estimatedDuration: number;
  readonly confidence: number;
}

export interface TestSelectionSelectOutputBudgetInsufficient {
  readonly variant: 'budgetInsufficient';
  readonly selected: readonly { readonly testId: string }[];
  readonly missedTests: number;
  readonly confidence: number;
}

export type TestSelectionSelectOutput = TestSelectionSelectOutputOk | TestSelectionSelectOutputBudgetInsufficient;

export interface TestSelectionRecordInput {
  readonly testId: string;
  readonly language: string;
  readonly testType: string;
  readonly coveredSources: readonly string[];
  readonly duration: number;
  readonly passed: boolean;
}

export interface TestSelectionRecordOutput {
  readonly variant: 'ok';
  readonly mapping: string;
}

export interface TestSelectionStatisticsInput {
}

export interface TestSelectionStatisticsOutput {
  readonly variant: 'ok';
  readonly stats: { readonly totalMappings: number; readonly avgSelectionRatio: number; readonly avgConfidence: number; readonly lastUpdated: Date };
}

// --- Variant constructors ---

export const analyzeOk = (affectedTests: readonly { readonly testId: string; readonly language: string; readonly testType: string; readonly relevance: number; readonly reason: string }[]): TestSelectionAnalyzeOutput => ({ variant: 'ok', affectedTests } as TestSelectionAnalyzeOutput);
export const analyzeNoMappings = (message: string): TestSelectionAnalyzeOutput => ({ variant: 'noMappings', message } as TestSelectionAnalyzeOutput);

export const selectOk = (selected: readonly { readonly testId: string; readonly language: string; readonly testType: string; readonly priority: number }[], estimatedDuration: number, confidence: number): TestSelectionSelectOutput => ({ variant: 'ok', selected, estimatedDuration, confidence } as TestSelectionSelectOutput);
export const selectBudgetInsufficient = (selected: readonly { readonly testId: string }[], missedTests: number, confidence: number): TestSelectionSelectOutput => ({ variant: 'budgetInsufficient', selected, missedTests, confidence } as TestSelectionSelectOutput);

export const recordOk = (mapping: string): TestSelectionRecordOutput => ({ variant: 'ok', mapping } as TestSelectionRecordOutput);

export const statisticsOk = (stats: { readonly totalMappings: number; readonly avgSelectionRatio: number; readonly avgConfidence: number; readonly lastUpdated: Date }): TestSelectionStatisticsOutput => ({ variant: 'ok', stats } as TestSelectionStatisticsOutput);

