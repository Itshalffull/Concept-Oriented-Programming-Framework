// Signature â€” types.ts
// Generated by NextjsGen. Do not edit manually.
// Uses fp-ts for purely functional, composable concept implementations.

// Storage interface for Signature
export interface SignatureStorage {
  readonly get: (relation: string, key: string) => Promise<Record<string, unknown> | null>;
  readonly put: (relation: string, key: string, value: Record<string, unknown>) => Promise<void>;
  readonly delete: (relation: string, key: string) => Promise<boolean>;
  readonly find: (relation: string, filter?: Record<string, unknown>) => Promise<readonly Record<string, unknown>[]>;
}

export interface SignatureSignInput {
  readonly contentHash: string;
  readonly identity: string;
}

export interface SignatureSignOutputOk {
  readonly variant: 'ok';
  readonly signatureId: string;
}

export interface SignatureSignOutputUnknownIdentity {
  readonly variant: 'unknownIdentity';
  readonly message: string;
}

export interface SignatureSignOutputHashNotFound {
  readonly variant: 'hashNotFound';
  readonly message: string;
}

export type SignatureSignOutput = SignatureSignOutputOk | SignatureSignOutputUnknownIdentity | SignatureSignOutputHashNotFound;

export interface SignatureVerifyInput {
  readonly contentHash: string;
  readonly signatureId: string;
}

export interface SignatureVerifyOutputValid {
  readonly variant: 'valid';
  readonly identity: string;
  readonly timestamp: string;
}

export interface SignatureVerifyOutputInvalid {
  readonly variant: 'invalid';
  readonly message: string;
}

export interface SignatureVerifyOutputExpired {
  readonly variant: 'expired';
  readonly message: string;
}

export interface SignatureVerifyOutputUntrustedSigner {
  readonly variant: 'untrustedSigner';
  readonly signer: string;
}

export type SignatureVerifyOutput = SignatureVerifyOutputValid | SignatureVerifyOutputInvalid | SignatureVerifyOutputExpired | SignatureVerifyOutputUntrustedSigner;

export interface SignatureTimestampInput {
  readonly contentHash: string;
}

export interface SignatureTimestampOutputOk {
  readonly variant: 'ok';
  readonly proof: Buffer;
}

export interface SignatureTimestampOutputUnavailable {
  readonly variant: 'unavailable';
  readonly message: string;
}

export type SignatureTimestampOutput = SignatureTimestampOutputOk | SignatureTimestampOutputUnavailable;

export interface SignatureAddTrustedSignerInput {
  readonly identity: string;
}

export interface SignatureAddTrustedSignerOutputOk {
  readonly variant: 'ok';
}

export interface SignatureAddTrustedSignerOutputAlreadyTrusted {
  readonly variant: 'alreadyTrusted';
  readonly message: string;
}

export type SignatureAddTrustedSignerOutput = SignatureAddTrustedSignerOutputOk | SignatureAddTrustedSignerOutputAlreadyTrusted;

// --- Variant constructors ---

export const signOk = (signatureId: string): SignatureSignOutput => ({ variant: 'ok', signatureId } as SignatureSignOutput);
export const signUnknownIdentity = (message: string): SignatureSignOutput => ({ variant: 'unknownIdentity', message } as SignatureSignOutput);
export const signHashNotFound = (message: string): SignatureSignOutput => ({ variant: 'hashNotFound', message } as SignatureSignOutput);

export const verifyValid = (identity: string, timestamp: string): SignatureVerifyOutput => ({ variant: 'valid', identity, timestamp } as SignatureVerifyOutput);
export const verifyInvalid = (message: string): SignatureVerifyOutput => ({ variant: 'invalid', message } as SignatureVerifyOutput);
export const verifyExpired = (message: string): SignatureVerifyOutput => ({ variant: 'expired', message } as SignatureVerifyOutput);
export const verifyUntrustedSigner = (signer: string): SignatureVerifyOutput => ({ variant: 'untrustedSigner', signer } as SignatureVerifyOutput);

export const timestampOk = (proof: Buffer): SignatureTimestampOutput => ({ variant: 'ok', proof } as SignatureTimestampOutput);
export const timestampUnavailable = (message: string): SignatureTimestampOutput => ({ variant: 'unavailable', message } as SignatureTimestampOutput);

export const addTrustedSignerOk = (): SignatureAddTrustedSignerOutput => ({ variant: 'ok' } as SignatureAddTrustedSignerOutput);
export const addTrustedSignerAlreadyTrusted = (message: string): SignatureAddTrustedSignerOutput => ({ variant: 'alreadyTrusted', message } as SignatureAddTrustedSignerOutput);

