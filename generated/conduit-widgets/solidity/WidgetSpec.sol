// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

/// @title WidgetTypes
/// @notice Shared COIF widget abstraction types for the Conduit application.
/// @dev Each widget is described by a WidgetSpec containing concept bindings,
///      anatomy, abstract element trees, finite state machines, and accessibility
///      metadata. This library provides the canonical on-chain type definitions
///      that all Conduit widget contracts reference.
///
/// Architecture:
///   ConceptSpec -> UISchema.inspect() -> ElementTree
///   ElementTree + MachineSpec + Anatomy + A11ySpec = WidgetSpec
///   WidgetSpec  -> FrameworkAdapter.normalize() -> rendered component

library WidgetTypes {

    // ---------------------------------------------------------------------------
    // Element kinds — abstract interaction units from COIF Element concept
    // ---------------------------------------------------------------------------

    enum ElementKind {
        InputText,        // 0
        InputNumber,      // 1
        InputDate,        // 2
        InputBool,        // 3
        SelectionSingle,  // 4
        SelectionMulti,   // 5
        Trigger,          // 6
        Navigation,       // 7
        OutputText,       // 8
        OutputNumber,     // 9
        OutputDate,       // 10
        OutputBool,       // 11
        Group,            // 12
        Container,        // 13
        RichText,         // 14
        FileUpload,       // 15
        MediaDisplay      // 16
    }

    // ---------------------------------------------------------------------------
    // Widget category — high-level classification
    // ---------------------------------------------------------------------------

    enum WidgetCategory {
        Form,        // 0
        Display,     // 1
        Composite,   // 2
        Navigation   // 3
    }

    // ---------------------------------------------------------------------------
    // Element tree — the abstract UI structure generated by UISchema.inspect()
    // ---------------------------------------------------------------------------

    struct ElementNode {
        string id;         // namespaced identifier, e.g. "registration.username"
        ElementKind kind;  // abstract element type
        string label;      // human-readable label
        string dataType;   // data type: "string", "number", "boolean", "void", "array"
        bool required;     // whether input is mandatory
        string scope;      // JSON pointer into concept state: #/properties/title
    }

    // ---------------------------------------------------------------------------
    // Concept binding — which concept actions and state a widget connects to
    // ---------------------------------------------------------------------------

    struct ConceptBinding {
        string concept;    // URI: "urn:copf/Article"
        string[] actions;  // actions this widget can invoke
    }

    // ---------------------------------------------------------------------------
    // Anatomy — named parts contract (from COIF Anatomy concept)
    // ---------------------------------------------------------------------------

    struct AnatomySpec {
        string component;  // e.g. "RegistrationForm"
        string[] parts;    // named structural parts
        string[] slots;    // insertion points for composition
    }

    // ---------------------------------------------------------------------------
    // Accessibility — ARIA + keyboard interactions (from COIF Widget a11ySpec)
    // ---------------------------------------------------------------------------

    struct A11ySpec {
        string role;       // ARIA role, e.g. "form", "article", "region"
        string label;      // accessible label for the widget
    }

    // ---------------------------------------------------------------------------
    // WidgetMeta — top-level metadata for a widget definition
    // ---------------------------------------------------------------------------

    struct WidgetMeta {
        string name;            // widget name, e.g. "registration"
        string version;         // semver, e.g. "1.0.0"
        WidgetCategory category; // form, display, composite, navigation
        string machineSpec;     // JSON-encoded state machine definition
    }
}
