// Validation gates entry â€” valid items proceed to storage, invalid items are quarantined

# When validation passes, persist the item to content storage
sync ValidToStorage [eager]
when {
  DataQuality/validate: [ item: ?item; rulesetId: ?rules ]
    => [ valid: "true"; score: ?score ]
}
then {
  ContentStorage/save: [ record: ?item; data: ?item ]
}

# When validation fails, quarantine the item with its violation details
sync InvalidToQuarantine [eager]
when {
  DataQuality/validate: [ item: ?item; rulesetId: ?rules ]
    => [ violations: ?violations ]
}
then {
  DataQuality/quarantine: [ itemId: ?item; violations: ?violations ]
}
