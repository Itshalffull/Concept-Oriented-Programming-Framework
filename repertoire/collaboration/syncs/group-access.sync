# Group-scoped access checks for collaborative actions

# When a user flags an entity, verify they have the required permission in the group
sync FlagWithinGroup [eager]
when {
  Flag/flag: [ flagging: ?flagging; flagType: ?type; entity: ?entity; user: ?user ]
    => [ flagging: ?flagging ]
}
then {
  Group/checkGroupAccess: [ group: ?entity; user: ?user; permission: ?type ]
}
